name: âš™ï¸ CI - PR Label Test

on:
  pull_request:
    types:
      - opened
      - reopened
      - synchronize
    branches: [main, develop]

jobs:
  check_pr_labels:
    runs-on: macos-15
    steps:
      - name: ğŸ” Check PR labels
        run: |
          echo "Checking PR labels..."

          # GitHubì—ì„œ ë‚´ë ¤ì˜¨ PR ì´ë²¤íŠ¸ë¥¼ í™•ì¸ìš©ìœ¼ë¡œ ì°ê¸°
          echo "github.event_name: ${{ github.event_name }}"
          echo "github.event.action: ${{ github.event.action }}"
          echo "github.event.pull_request.number: ${{ github.event.pull_request.number }}"
          echo "github.event.pull_request.title: ${{ github.event.pull_request.title }}"
          # labelsëŠ” ë°°ì—´ì´ë¼ toJsonìœ¼ë¡œ ì°ì–´ì¤˜ì•¼ í•¨
          echo "github.event.pull_request.labels (json): ${{ toJson(github.event.pull_request.labels) }}"

          # GitHubê°€ ë‚´ë ¤ì£¼ëŠ” ì´ë²¤íŠ¸ JSON íŒŒì¼ì—ì„œ ë¼ë²¨ë§Œ ë½‘ê¸°
          labels=$(jq -r '.pull_request.labels[].name // empty' "$GITHUB_EVENT_PATH")

          echo "Detected labels: $labels"

          if echo "$labels" | grep -q "âš™ï¸ ENV"; then
            echo "âœ… 'âš™ï¸ ENV' label detected."
            exit 1 // ë‹¤ìŒ ìŠ¤í… ì§„í–‰í•˜ì§€ ì•Šê³ , ì›Œí¬ í”Œë¡œìš° ì¢…ë£Œ
          else
            echo "â 'âš™ï¸ ENV' label not found."
          fi

      - name: Some Next Step
        run: |
          echo "next step..."

      - name: Some Next Step2
        run: |
          echo "next step2..."