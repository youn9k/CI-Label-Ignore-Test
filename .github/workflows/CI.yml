name: âš™ï¸ CI - PR Label Test

on:
  pull_request:
    types:
      - opened
      - reopened
      - synchronize
    branches: [main, develop]

jobs:
  check_pr_labels:
    runs-on: macos-15
    steps:
      - name: ðŸ” Check PR labels
        id: check
        run: |
          echo "Checking PR labels..."

          # GitHubì—ì„œ ë‚´ë ¤ì˜¨ PR ì´ë²¤íŠ¸ë¥¼ í™•ì¸ìš©ìœ¼ë¡œ ì°ê¸°
          echo "github.event_name: ${{ github.event_name }}"
          echo "github.event.action: ${{ github.event.action }}"
          echo "github.event.pull_request.number: ${{ github.event.pull_request.number }}"
          echo "github.event.pull_request.title: ${{ github.event.pull_request.title }}"
          echo "github.event.pull_request.labels (json): ${{ toJson(github.event.pull_request.labels) }}"

          # GitHub ì´ë²¤íŠ¸ JSONì—ì„œ ë¼ë²¨ë§Œ ì¶”ì¶œ
          labels=$(jq -r '.pull_request.labels[].name // empty' "$GITHUB_EVENT_PATH")
          echo "Detected labels: $labels"

          # ê²°ê³¼ë¥¼ outputìœ¼ë¡œ ì „ë‹¬
          if echo "$labels" | grep -q "âš™ï¸ ENV"; then
            echo "âœ… 'âš™ï¸ ENV' label detected."
            echo "skip_ci=true" >> "$GITHUB_OUTPUT"
          else
            echo "âŽ 'âš™ï¸ ENV' label not found."
            echo "skip_ci=false" >> "$GITHUB_OUTPUT"
          fi

      - name: Some Next Step
        if: steps.check.outputs.skip_ci == 'false'
        run: |
          echo "next step..."

      - name: Some Next Step2
        if: steps.check.outputs.skip_ci == 'false'
        run: |
          echo "next step2..."